function updateMedalistHistory() {
  const url = "https://olympic.ca/team-canada-medallists-at-milano-cortina-2026/?t=" + new Date().getTime();
  
  try {
    const response = UrlFetchApp.fetch(url, { "muteHttpExceptions": true });
    const html = response.getContentText();
    
    // Scrape the latest medalist
    const nameMatch = html.match(/<h3[^>]*class="medallist-name"[^>]*>(.*?)<\/h3>/);
    const sportMatch = html.match(/<span[^>]*class="sport"[^>]*>(.*?)<\/span>/);
    const medalMatch = html.match(/<span[^>]*class="medal (.*?)"/);
    
    if (nameMatch && sportMatch && medalMatch) {
      const name = nameMatch[1].replace(/&nbsp;/g, ' ').trim();
      const sport = sportMatch[1].trim();
      const medal = medalMatch[1].trim();

      const ss = SpreadsheetApp.getActiveSpreadsheet();
      let sheet = ss.getSheetByName("Medalists");
      if (!sheet) { 
        sheet = ss.insertSheet("Medalists");
        // Create headers if it's a brand new sheet
        sheet.getRange("A1:D1").setValues([["Athlete", "Sport", "Medal", "Date Recorded"]]);
        sheet.getRange("A1:D1").setFontWeight("bold").setBackground("#eeeeee");
      }

      // CHECK ROW 2: This is where our most recent data lives (just below header)
      const latestInSheet = sheet.getRange("A2").getValue();

      if (name !== latestInSheet) {
        // Insert a new blank row AT Row 2 (preserving Row 1 as Header)
        sheet.insertRowAfter(1); 
        
        // Write the new data to the newly created Row 2
        sheet.getRange("A2:D2").setValues([[name, sport, medal, new Date().toLocaleDateString()]]);
        console.log("New Medal Added below header: " + name);
      } else {
        console.log("No new medal found. Current latest is still: " + name);
      }
    }
  } catch (e) {
    console.log("Sync Error: " + e.toString());
  }
}
